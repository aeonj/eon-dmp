function addUIByServer(comp,ray,pos){var initcol=0,initrow=0,pnl,isonecol=!1,relations=[],elenames=[];if(void 0!==ray.detail){var ray_detail=ray.detail,downcol=0,lastcol=-1,setOtherProp=function(e,i){e.data_type="checkbox"==i||"chkfield"==i||"radiogroup"==i||"moneyfield"==i||"percentfield"==i||"custnumberfield"==i?"number":"datefield"==i||"datetimefield"==i?"date":"string"};if(void 0===comp.lastitems)for(var k=0;k<ray_detail.length;k++)"hidden"!=ray_detail[k].field_type&&1!=ray_detail[k].hidden&&(downcol+=ray_detail[k].cols),downcol>ray_detail[k].total_column&&(downcol=ray_detail[k].cols,lastcol=k-1);else lastcol=99;for(var i=0;i<ray_detail.length;i++){var items={};"button"==ray_detail[i].field_type?items.text=ray_detail[i].field_title:(items.name=ray_detail[i].field_name,items.fieldLabel=ray_detail[i].field_title),items.xtype=ray_detail[i].field_type,items.logic=ray_detail[i].field_logic,setOtherProp(items,items.xtype);var children=ray_detail[i].children;if(children&&"object"==typeof children){for(var j=0,colWidth,pnlCol,padding,padding;j<children.length;j++)"{{"==children[j].uiconf_value.slice(0,2)&&"}}"==children[j].uiconf_value.slice(-2)?items[children[j].uiconf_field]=eval(children[j].uiconf_value.slice(2,-2)):"boolean"==children[j].uiconf_datatype?items[children[j].uiconf_field]="true"==children[j].uiconf_value:"int"==children[j].uiconf_datatype?items[children[j].uiconf_field]=+children[j].uiconf_value:"float"==children[j].uiconf_datatype?items[children[j].uiconf_field]=parseFloat(children[j].uiconf_value):"string"==children[j].uiconf_datatype?items[children[j].uiconf_field]=children[j].uiconf_value:comp.isPreview||("store"==children[j].uiconf_field?items[children[j].uiconf_field]=eval(children[j].uiconf_value+"Store"):items[children[j].uiconf_field]=eval(children[j].uiconf_value)),"source"==children[j].uiconf_field&&elenames.push({source:children[j].uiconf_value,compname:items.name});Ext.isEmpty(items.allowBlank)?Ext.isEmpty(items.readOnly)||1==items.readOnly&&(items.fieldStyle="cursor: default; pointer-events: none; color: black !important; background: #F6F6F6;"):0==items.allowBlank&&(items.afterLabelTextTpl=['<span style="color:red;font-weight:bold" data-qtip="Required">*</span>'],items.labelStyle=micolor),"form"==comp.getLayout().type?(comp.add(Ext.create(items)),isonecol=!0):"hidden"==ray_detail[i].field_type||items.hidden?comp.add(Ext.create(items)):(colWidth=initcol+ray_detail[i].cols>=ray_detail[i].total_column?(ray_detail[i].total_column-initcol)/ray_detail[i].total_column:ray_detail[i].cols/ray_detail[i].total_column,padding=lastcol<i?0==initrow?"10 12 10 12":"3 12 10 12":0==initrow?"10 12 3 12":"3 12 3 12",pnlCol=Ext.create("Ext.panel.Panel",{columnWidth:colWidth,layout:"fit",padding:padding,labelWidth:comp.labelWidth,border:!1,items:[items]}),comp.add(pnlCol),initcol+ray_detail[i].cols>=ray_detail[i].total_column||i==ray_detail.length-1?(initcol=0,initrow++):initcol+=ray_detail[i].cols)}}}if(void 0!==comp.lastitems)for(var i=0,pnlCol;i<comp.lastitems.length;i++){isonecol?comp.add(Ext.create(comp.lastitems[i])):(pnlCol=new Ext.Panel(comp.lastitems[i]),comp.add(pnlCol))}if(void 0!==ray.main){for(var ray_main=ray.main,items={},j=0;j<ray_main.length;j++)if("{{"==ray_main[j].uiconf_value.slice(0,2)&&"}}"==ray_main[j].uiconf_value.slice(-2)?items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2)):"boolean"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]="true"==ray_main[j].uiconf_value:"int"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=+ray_main[j].uiconf_value:"float"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value):"string"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value:comp.isPreview||(items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value)),"isRelation"==ray_main[j].uiconf_field&&"true"==ray_main[j].uiconf_value){var relamanager=eon_relation_ele||[];elenames.forEach(function(e){for(var i=[],a=0;a<relamanager.length;a++)if(relamanager[a].prisource==e.source)for(var n=0;n<elenames.length;n++)elenames[n].source==relamanager[a].secsource&&i.push({secsource:elenames[n].source,seccompname:elenames[n].compname});0<i.length&&relations.push({prisource:e.source,pricompname:e.compname,secs:i})});for(var i=0;i<relations.length;i++)for(var secs=relations[i].secs,k=0;k<secs.length;k++){var sec_comp=comp.getForm().findField(secs[k].seccompname);sec_comp&&void 0===sec_comp.isRelation&&(sec_comp.isRelation=!0)}for(var i=0;i<relations.length;i++){var pri_comp=comp.getForm().findField(relations[i].pricompname);pri_comp&&(pri_comp.ownerPanel=comp,pri_comp.relationCtl=relations[i],pri_comp.on("select",function(e,i){for(var a=e.ownerPanel,n=e.relationCtl.secs,t=0;t<n.length;t++){var l=a.getForm().findField(n[t].seccompname);l&&l.isRelation&&l.reset()}}),pri_comp.on("afterchange",function(e,i,a){for(var n=e.ownerPanel,t=e.relationCtl.secs,l=e.relationCtl.prisource,r=0;r<t.length;r++){var o=n.getForm().findField(t[r].seccompname);if(o&&o.isRelation){if(containsArray(o.getRelations(),l,"source")){for(var c=-1,d=0;d<o.getRelations().length;d++)if(o.getRelations()[d].source===l){c=d;break}-1<c&&o.removeRelations(c)}o.requestload=!0,o.appendRelations({source:l,value:i})}}}))}}comp.execMethod&&comp.execMethod(items)}}function addGridByServer(comp,ray){var newColumnModel,newStore,store,cm;if(void 0!==ray.detail&&(newColumnModel=function(comp,ray,store){for(var cmArray=[],findIsCodeAsValue=function(e){for(var i=0;i<e.length;i++)if("isCodeAsValue"==e[j].uiconf_field)return!0;return!1},setOtherProp=function(e,i){"checkbox"==i||"chkfield"==i?e.renderer=YESNORender:"radiogroup"==i||"hidden"==i&&(e.hidden=!0)},i=0;null!=ray&&i<ray.length;i++){var newField={header:ray[i].field_title,dataIndex:ray[i].field_name,sortable:!0,parentData:comp.parentData,width:ray[i].width};setOtherProp(newField,ray[i].field_type);var children=ray[i].children;if(children&&"object"==typeof children)for(var j=0;j<children.length;j++)comp.isPreview||("colmodel"==ray[i].field_type?"boolean"==children[j].uiconf_datatype?newField[children[j].uiconf_field]="true"==children[j].uiconf_value:"int"==children[j].uiconf_datatype?newField[children[j].uiconf_field]=+children[j].uiconf_value:"float"==children[j].uiconf_datatype?newField[children[j].uiconf_field]=parseFloat(children[j].uiconf_value):"string"==children[j].uiconf_datatype?(newField[children[j].uiconf_field]=children[j].uiconf_value,"enumData"==children[j].uiconf_field&&(newField.renderer=eval("typeof columnEnumRender!='undefined' ? columnEnumRender : null"))):newField[children[j].uiconf_field]=eval("typeof "+children[j].uiconf_value+"!='undefined' ? "+children[j].uiconf_value+" : null"):"source"==children[j].uiconf_field?findIsCodeAsValue(children)?newField.renderer=eval("typeof "+children[j].uiconf_value+"CodeRender!='undefined' ? "+children[j].uiconf_value+"CodeRender : objEntityRender"):newField.renderer=eval("typeof "+children[j].uiconf_value+"IdRender!='undefined' ? "+children[j].uiconf_value+"IdRender : objEntityRender"):"store"==children[j].uiconf_field?newField.renderer=eval("typeof "+children[j].uiconf_value.replace("Store","Render")+"!='undefined' ? "+children[j].uiconf_value.replace("Store","Render")+" : null"):"enumData"==children[j].uiconf_field?(eval("function "+newField.dataIndex+'EnumRender(v) {return enumRender(v,"'+children[j].uiconf_value+'")};'),newField.renderer=eval("typeof "+newField.dataIndex+"EnumRender!='undefined' ? "+newField.dataIndex+"EnumRender : null")):"renderer"==children[j].uiconf_field&&(newField.renderer=eval("typeof "+children[j].uiconf_value+"!='undefined' ? "+children[j].uiconf_value+" : null")));cmArray.push(newField)}return typeof this==Ext.vcf.EditorColumnModel?new Ext.vcf.EditorColumnModel(comp.columnBase.concat(cmArray),store,comp.editDataIndex):comp.columnBase.concat(cmArray)},newStore=function(e,i){for(var a=[],n=0;null!=i&&n<i.length;n++){var t={name:i[n].field_name};a.push(t)}var l=Ext.create("Ext.data.Model",{fields:e.fieldBase.concat(a)});return Ext.create("Ext.data.Store",{pageSize:50,model:l,proxy:{type:"ajax",url:e.url,actionMethods:{read:"POST"},reader:{type:"json",totalProperty:"total",rootProperty:"data",implicitIncludes:!1}}})},store=newStore(comp,ray.detail),cm=newColumnModel(comp,ray.detail,store),comp.reconfigure(store,cm),comp.autoQuery&&comp.store.load(comp.params)),void 0!==ray.main){for(var ray_main=ray.main,items={},j=0;j<ray_main.length;j++)"{{"==ray_main[j].uiconf_value.slice(0,2)&&"}}"==ray_main[j].uiconf_value.slice(-2)?items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2)):"boolean"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]="true"==ray_main[j].uiconf_value:"int"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=+ray_main[j].uiconf_value:"float"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value):"string"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value:comp.isPreview||(items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value));comp.execMethod(items)}}Ext.override(Ext.vcf.FormPanel,{isPreview:!1,initUI:function(){var n=this;Ext.Ajax.request({url:"/manage/ui_designer.htm",success:function(e){var i,a=Ext.JSON.decode(e.responseText);addUIByServer(n,a),n.ajaxLoaded=!0,n instanceof Ext.vcf.QueryPanel==!0&&(!n.stateChange||(i=n.getForm().findField("state"))&&("undefined"!=typeof main_action&&main_action.onStateChange(i.getValue()),i.on("select",function(e){n.stateChange(e),main_action&&main_action.onStateChange(i.getValue())}))),n.hasListeners.afterloadui&&n.fireEvent("afterloadui",n)},failure:function(e){},params:{comp_id:n.viewid||n.getId(),menu_id:MENU_ID||"",servletpath:webServlet||"/"}})},execMethod:function(e){for(var i in e){var a=e[i];if("title"==i)this.setTitle(a);else if("height"==i)this.setHeight(a);else if("width"==i)this.setWidth(a);else if("listeners"==i)for(var n in a)this.on(n,a[n])}}}),Ext.override(Ext.vcf.TableGrid,{isPreview:!1,isLoadConfig:!1,initConfig1:function(){var comp=this;comp.isLoadConfig||Ext.Ajax.request({url:"/manage/uimain_designer.htm",success:function(response){for(var resultArray=Ext.JSON.decode(response.responseText),ray_main=resultArray,items={},j=0;j<ray_main.length;j++)"{{"==ray_main[j].uiconf_value.slice(0,2)&&"}}"==ray_main[j].uiconf_value.slice(-2)?items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2)):"boolean"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]="true"==ray_main[j].uiconf_value:"int"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=+ray_main[j].uiconf_value:"float"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value):"string"==ray_main[j].uiconf_datatype?items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value:comp.isPreview||(items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value));items.isLoadConfig=!0,comp=comp.cloneConfig(items)},failure:function(e){comp.isLoadConfig=!0},params:{comp_id:comp.viewid||comp.id,menu_id:MENU_ID||"",servletpath:webServlet||"/"}})},initUI:function(){var a=this;Ext.Ajax.request({url:"/manage/ui_designer.htm",success:function(e){var i=Ext.JSON.decode(e.responseText);addGridByServer(a,i),a.ajaxLoaded=!0,a.hasListeners.afterloadui&&a.fireEvent("afterloadui",a)},failure:function(e){uiArray=null},params:{comp_id:a.viewid||a.getId(),menu_id:MENU_ID||"",servletpath:webServlet||"/"}})},execMethod:function(e){for(var i in e){var a=e[i];if("title"==i)this.setTitle(a);else if("height"==i)this.setHeight(a);else if("width"==i)this.setWidth(a);else if("listeners"==i)for(var n in a)this.on(n,a[n]);else"limit"==i&&this.pagesize_combo.setValue(a)}}});