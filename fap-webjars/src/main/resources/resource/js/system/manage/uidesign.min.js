Ext.override(Ext.vcf.FormPanel,{isPreview:false,initUI:function(){var a=this;Ext.Ajax.request({url:"/manage/ui_designer.htm",success:function(b){var d=Ext.JSON.decode(b.responseText);addUIByServer(a,d);a.ajaxLoaded=true;if(a instanceof (Ext.vcf.QueryPanel)===true){if(a.stateChange){var c=a.getForm().findField("state");if(c){if(typeof main_action!="undefined"){main_action.onStateChange(c.getValue())}c.on("select",function(e){a.stateChange(e);if(main_action){main_action.onStateChange(c.getValue())}})}}}if(a.hasListeners.afterloadui){a.fireEvent("afterloadui",a)}},failure:function(b){},params:{comp_id:a.viewid||a.getId(),menu_id:MENU_ID||"",servletpath:webServlet||"/"}})},execMethod:function(b){for(var a in b){var d=b[a];if(a=="title"){this.setTitle(d)}else{if(a=="height"){this.setHeight(d)}else{if(a=="width"){this.setWidth(d)}else{if(a=="listeners"){for(var c in d){this.on(c,d[c])}}}}}}}});Ext.override(Ext.vcf.TableGrid,{isPreview:false,isLoadConfig:false,initConfig1:function(){var comp=this;if(!comp.isLoadConfig){Ext.Ajax.request({url:"/manage/uimain_designer.htm",success:function(response){var resultArray=Ext.JSON.decode(response.responseText);var ray_main=resultArray;var items={};for(var j=0;j<ray_main.length;j++){if(ray_main[j].uiconf_value.slice(0,2)=="{{"&&ray_main[j].uiconf_value.slice(-2)=="}}"){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2))}else{if(ray_main[j].uiconf_datatype=="boolean"){items[ray_main[j].uiconf_field]=(ray_main[j].uiconf_value=="true")}else{if(ray_main[j].uiconf_datatype=="int"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value-0}else{if(ray_main[j].uiconf_datatype=="float"){items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value)}else{if(ray_main[j].uiconf_datatype=="string"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value}else{if(!comp.isPreview){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value)}}}}}}}items.isLoadConfig=true;comp=comp.cloneConfig(items)},failure:function(response){comp.isLoadConfig=true},params:{comp_id:comp.viewid||comp.id,menu_id:MENU_ID||"",servletpath:webServlet||"/"}})}},initUI:function(){var a=this;Ext.Ajax.request({url:"/manage/ui_designer.htm",success:function(b){var c=Ext.JSON.decode(b.responseText);addGridByServer(a,c);a.ajaxLoaded=true;if(a.hasListeners.afterloadui){a.fireEvent("afterloadui",a)}},failure:function(b){uiArray=null},params:{comp_id:a.viewid||a.getId(),menu_id:MENU_ID||"",servletpath:webServlet||"/"}})},execMethod:function(b){for(var a in b){var d=b[a];if(a=="title"){this.setTitle(d)}else{if(a=="height"){this.setHeight(d)}else{if(a=="width"){this.setWidth(d)}else{if(a=="listeners"){for(var c in d){this.on(c,d[c])}}else{if(a=="limit"){this.pagesize_combo.setValue(d)}}}}}}}});function addUIByServer(comp,ray,pos){var initcol=0,initrow=0,pnl,isonecol=false,relations=[],elenames=[];if(typeof ray.detail!="undefined"){var ray_detail=ray.detail;var downcol=0,lastcol=-1;var setOtherProp=function(colray,fieldtype){if(fieldtype=="checkbox"||fieldtype=="chkfield"||fieldtype=="radiogroup"){colray.data_type="number"}else{if(fieldtype=="moneyfield"||fieldtype=="percentfield"||fieldtype=="custnumberfield"){colray.data_type="number"}else{if(fieldtype=="datefield"||fieldtype=="datetimefield"){colray.data_type="date"}else{colray.data_type="string"}}}};if(typeof comp.lastitems=="undefined"){for(var k=0;k<ray_detail.length;k++){if(ray_detail[k].field_type!="hidden"&&ray_detail[k].hidden!=1){downcol=downcol+ray_detail[k].cols}if(downcol>ray_detail[k].total_column){downcol=ray_detail[k].cols;lastcol=k-1}}}else{lastcol=99}for(var i=0;i<ray_detail.length;i++){var items={};if(ray_detail[i].field_type=="button"){items.text=ray_detail[i].field_title}else{items.name=ray_detail[i].field_name;items.fieldLabel=ray_detail[i].field_title}items.xtype=ray_detail[i].field_type;items.logic=ray_detail[i].field_logic;setOtherProp(items,items.xtype);var children=ray_detail[i].children;if(children&&typeof children=="object"){for(var j=0;j<children.length;j++){if(children[j].uiconf_value.slice(0,2)=="{{"&&children[j].uiconf_value.slice(-2)=="}}"){items[children[j].uiconf_field]=eval(children[j].uiconf_value.slice(2,-2))}else{if(children[j].uiconf_datatype=="boolean"){items[children[j].uiconf_field]=(children[j].uiconf_value=="true")}else{if(children[j].uiconf_datatype=="int"){items[children[j].uiconf_field]=children[j].uiconf_value-0}else{if(children[j].uiconf_datatype=="float"){items[children[j].uiconf_field]=parseFloat(children[j].uiconf_value)}else{if(children[j].uiconf_datatype=="string"){items[children[j].uiconf_field]=children[j].uiconf_value}else{if(!comp.isPreview){if(children[j].uiconf_field=="store"){items[children[j].uiconf_field]=eval(children[j].uiconf_value+"Store")}else{items[children[j].uiconf_field]=eval(children[j].uiconf_value)}}}}}}}if(children[j].uiconf_field=="source"){elenames.push({source:children[j].uiconf_value,compname:items.name})}}if(!Ext.isEmpty(items.allowBlank)){if(items.allowBlank==false){items.afterLabelTextTpl=['<span style="color:red;font-weight:bold" data-qtip="Required">*</span>'];items.labelStyle=micolor}}else{if(!Ext.isEmpty(items.readOnly)){if(items.readOnly==true){items.fieldStyle="cursor: default; pointer-events: none; color: black !important; background: #F6F6F6;"}}}if(comp.getLayout().type=="form"){comp.add(Ext.create(items));isonecol=true}else{if(ray_detail[i].field_type=="hidden"||items.hidden){comp.add(Ext.create(items))}else{var colWidth=(initcol+ray_detail[i].cols>=ray_detail[i].total_column)?((ray_detail[i].total_column-initcol)/ray_detail[i].total_column):ray_detail[i].cols/ray_detail[i].total_column;var pnlCol,padding;if(i>lastcol){if(initrow==0){padding="10 12 10 12"}else{padding="3 12 10 12"}}else{if(initrow==0){padding="10 12 3 12"}else{padding="3 12 3 12"}}pnlCol=Ext.create("Ext.panel.Panel",{columnWidth:colWidth,layout:"fit",padding:padding,labelWidth:comp.labelWidth,border:false,items:[items]});comp.add(pnlCol);if(initcol+ray_detail[i].cols>=ray_detail[i].total_column||i==ray_detail.length-1){initcol=0;initrow++}else{initcol=initcol+ray_detail[i].cols}}}}}}if(typeof comp.lastitems!="undefined"){for(var i=0;i<comp.lastitems.length;i++){if(isonecol){comp.add(Ext.create(comp.lastitems[i]))}else{var pnlCol=new Ext.Panel(comp.lastitems[i]);comp.add(pnlCol)}}}if(typeof ray.main!="undefined"){var ray_main=ray.main;var items={};for(var j=0;j<ray_main.length;j++){if(ray_main[j].uiconf_value.slice(0,2)=="{{"&&ray_main[j].uiconf_value.slice(-2)=="}}"){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2))}else{if(ray_main[j].uiconf_datatype=="boolean"){items[ray_main[j].uiconf_field]=(ray_main[j].uiconf_value=="true")}else{if(ray_main[j].uiconf_datatype=="int"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value-0}else{if(ray_main[j].uiconf_datatype=="float"){items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value)}else{if(ray_main[j].uiconf_datatype=="string"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value}else{if(!comp.isPreview){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value)}}}}}}if(ray_main[j].uiconf_field=="isRelation"&&ray_main[j].uiconf_value=="true"){var relamanager=eon_relation_ele||[];elenames.forEach(function(ele){var secs=[];for(var m=0;m<relamanager.length;m++){if(relamanager[m].prisource==ele.source){for(var n=0;n<elenames.length;n++){if(elenames[n].source==relamanager[m].secsource){secs.push({secsource:elenames[n].source,seccompname:elenames[n].compname})}}}}if(secs.length>0){relations.push({prisource:ele.source,pricompname:ele.compname,secs:secs})}});for(var i=0;i<relations.length;i++){var secs=relations[i].secs;for(var k=0;k<secs.length;k++){var sec_comp=comp.getForm().findField(secs[k].seccompname);if(sec_comp){if(typeof sec_comp.isRelation=="undefined"){sec_comp.isRelation=true}}}}for(var i=0;i<relations.length;i++){var pri_comp=comp.getForm().findField(relations[i].pricompname);if(pri_comp){pri_comp.ownerPanel=comp;pri_comp.relationCtl=relations[i];pri_comp.on("select",function(picker,node){var pnl_comp=picker.ownerPanel,secs=picker.relationCtl.secs;for(var k=0;k<secs.length;k++){var sec_comp=pnl_comp.getForm().findField(secs[k].seccompname);if(sec_comp&&sec_comp.isRelation){sec_comp.reset()}}});pri_comp.on("afterchange",function(picker,value,oldvalue){var pnl_comp=picker.ownerPanel,secs=picker.relationCtl.secs,pri_source=picker.relationCtl.prisource;for(var k=0;k<secs.length;k++){var sec_comp=pnl_comp.getForm().findField(secs[k].seccompname);if(sec_comp&&sec_comp.isRelation){if(containsArray(sec_comp.getRelations(),pri_source,"source")){var index=-1;for(var j=0;j<sec_comp.getRelations().length;j++){if(sec_comp.getRelations()[j].source===pri_source){index=j;break}}if(index>-1){sec_comp.removeRelations(index)}}sec_comp.requestload=true;sec_comp.appendRelations({source:pri_source,value:value})}}})}}}}if(comp.execMethod){comp.execMethod(items)}}}function addGridByServer(comp,ray){if(typeof ray.detail!="undefined"){var newColumnModel=function(comp,ray,store){var cmArray=[],colObj={};var findIsCodeAsValue=function(childs){for(var k=0;k<childs.length;k++){if(childs[j].uiconf_field=="isCodeAsValue"){return true}}return false};var setOtherProp=function(colray,fieldtype){if(fieldtype=="checkbox"||fieldtype=="chkfield"){colray.renderer=YESNORender}else{if(fieldtype=="radiogroup"){}else{if(fieldtype=="hidden"){colray.hidden=true}}}};for(var i=0;ray!=null&&i<ray.length;i++){var newField={header:ray[i].field_title,dataIndex:ray[i].field_name,sortable:true,parentData:comp.parentData,width:ray[i].width};setOtherProp(newField,ray[i].field_type);var children=ray[i].children;if(children&&typeof children=="object"){for(var j=0;j<children.length;j++){if(!comp.isPreview){if(ray[i].field_type=="colmodel"){if(children[j].uiconf_datatype=="boolean"){newField[children[j].uiconf_field]=(children[j].uiconf_value=="true")}else{if(children[j].uiconf_datatype=="int"){newField[children[j].uiconf_field]=children[j].uiconf_value-0}else{if(children[j].uiconf_datatype=="float"){newField[children[j].uiconf_field]=parseFloat(children[j].uiconf_value)}else{if(children[j].uiconf_datatype=="string"){newField[children[j].uiconf_field]=children[j].uiconf_value;if(children[j].uiconf_field=="enumData"){newField.renderer=eval("typeof columnEnumRender!='undefined' ? columnEnumRender : null")}}else{newField[children[j].uiconf_field]=eval("typeof "+children[j].uiconf_value+"!='undefined' ? "+children[j].uiconf_value+" : null")}}}}}else{if(children[j].uiconf_field=="source"){if(findIsCodeAsValue(children)){newField.renderer=eval("typeof "+children[j].uiconf_value+"CodeRender!='undefined' ? "+children[j].uiconf_value+"CodeRender : objEntityRender")}else{newField.renderer=eval("typeof "+children[j].uiconf_value+"IdRender!='undefined' ? "+children[j].uiconf_value+"IdRender : objEntityRender")}}else{if(children[j].uiconf_field=="store"){newField.renderer=eval("typeof "+children[j].uiconf_value.replace("Store","Render")+"!='undefined' ? "+children[j].uiconf_value.replace("Store","Render")+" : null")}else{if(children[j].uiconf_field=="enumData"){eval("function "+newField.dataIndex+'EnumRender(v) {return enumRender(v,"'+children[j].uiconf_value+'")};');newField.renderer=eval("typeof "+newField.dataIndex+"EnumRender!='undefined' ? "+newField.dataIndex+"EnumRender : null")}else{if(children[j].uiconf_field=="renderer"){newField.renderer=eval("typeof "+children[j].uiconf_value+"!='undefined' ? "+children[j].uiconf_value+" : null")}}}}}}}}colObj[ray[i].id]=newField}for(var i=0;ray!=null&&i<ray.length;i++){var colId=ray[i].parent_id;if(colId==null){cmArray.push(colObj[ray[i].id]);continue}if(colObj[colId].columns){colObj[colId].columns.push(colObj[ray[i].id])}else{for(var key in colObj[colId]){if(key!="header"){delete colObj[colId][key]}}colObj[colId].columns=[colObj[ray[i].id]]}}for(var i=0;ray!=null&&i<ray.length;i++){var colId=ray[i].id;if(colObj[colId].columns){ray[i].isLeaf=false}else{ray[i].isLeaf=true}}if(typeof this==Ext.vcf.EditorColumnModel){return new Ext.vcf.EditorColumnModel(comp.columnBase.concat(cmArray),store,comp.editDataIndex)}else{return comp.columnBase.concat(cmArray)}};var newStore=function(comp,ray){var stArray=[];for(var i=0;ray!=null&&i<ray.length;i++){if(ray[i].isLeaf){var newField={name:ray[i].field_name};stArray.push(newField)}}var recNew=Ext.create("Ext.data.Model",{fields:comp.fieldBase.concat(stArray)});var reStore=Ext.create("Ext.data.Store",{pageSize:50,model:recNew,proxy:{type:"ajax",url:comp.url,actionMethods:{read:"POST"},reader:{type:"json",totalProperty:"total",rootProperty:"data",implicitIncludes:false}}});return reStore};var store=newStore(comp,ray.detail);var cm=newColumnModel(comp,ray.detail,store);comp.reconfigure(store,cm);if(comp.autoQuery){comp.store.load(comp.params)}}if(typeof ray.main!="undefined"){var ray_main=ray.main;var items={};for(var j=0;j<ray_main.length;j++){if(ray_main[j].uiconf_value.slice(0,2)=="{{"&&ray_main[j].uiconf_value.slice(-2)=="}}"){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value.slice(2,-2))}else{if(ray_main[j].uiconf_datatype=="boolean"){items[ray_main[j].uiconf_field]=(ray_main[j].uiconf_value=="true")}else{if(ray_main[j].uiconf_datatype=="int"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value-0}else{if(ray_main[j].uiconf_datatype=="float"){items[ray_main[j].uiconf_field]=parseFloat(ray_main[j].uiconf_value)}else{if(ray_main[j].uiconf_datatype=="string"){items[ray_main[j].uiconf_field]=ray_main[j].uiconf_value}else{if(!comp.isPreview){items[ray_main[j].uiconf_field]=eval(ray_main[j].uiconf_value)}}}}}}}comp.execMethod(items)}};